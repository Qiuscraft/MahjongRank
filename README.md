# MahjongRank

本项目是一个立直麻将段位系统。

## 1. 项目运行

### 1.1 安装

确保安装了依赖：

```bash
pnpm install
```

新建`.env`文件，复制`.env.example`中的内容到`.env`中，并配置所有环境变量。

### 1.2 开发服务器

在`http://localhost:3000`启动开发服务器：

```bash
pnpm dev
```

### 1.3 生产

构建生产制品：

```bash
# npm
pnpm build
```

本地预览构建结果：

```bash
pnpm preview
```

查看[部署文档](https://nuxt.com/docs/getting-started/deployment)以获得更多信息。

## 2. 项目设计文档

### 2.1 前端设计

#### 2.1.1 个人主页

| 显示内容                     | 是否实现 |
|--------------------------|------|
| 排名                       |      |
| 总局数                      | √    |
| 段位                       |      |
| 最高点数                     | √    |
| 平均点数                     | √    |
| 平均顺位                     | √    |
| 顺位饼状图                    | √    |
| 数据维度图（火力、防守、稳定、运势、技术、进攻） |      |

### 2.2 后端及接口设计

[Apifox](https://apifox.com/apidoc/shared/b793d103-e1b8-4e3c-aac3-ad5f49dd785d)

## 3. 项目需求文档

### 3.1 雀魂规 - 线下改版

***注：以下规则基于雀魂规制作，但为了适应线下慢节奏的比赛，机制相比雀魂有一些不同。所有不同点均用粗体斜体标出。***

#### 3.1.1 段位说明

***每个段位的初始分和升级分都是雀魂中的1/2。***

| 段位   | 初始分  | 升级分  |
|------|------|------|
| 初心1星 | 0    | 10   |
| 初心2星 | 0    | 40   |
| 初心3星 | 0    | 100  |
| 雀士1星 | 150  | 300  |
| 雀士2星 | 200  | 400  |
| 雀士3星 | 250  | 500  |
| 雀杰1星 | 300  | 600  |
| 雀杰2星 | 350  | 700  |
| 雀杰3星 | 500  | 1000 |
| 雀豪1星 | 700  | 1400 |
| 雀豪2星 | 800  | 1600 |
| 雀豪3星 | 900  | 1800 |
| 雀圣1星 | 1000 | 2000 |
| 雀圣2星 | 1500 | 3000 |
| 雀圣3星 | 2250 | 4500 |

#### 3.1.2 比赛说明

**比赛等级评定**

***每场比赛，根据参与的4名玩家的段位最高者的当前段位评定比赛等级。***

| 段位 | 比赛等级 |
|----|------|
| 初心 | 铜之间  |
| 雀士 | 银之间  |
| 雀杰 | 金之间  |
| 雀豪 | 玉之间  |
| 雀圣 | 王座之间 |

**分数计算**

比赛结束后，根据每位玩家持有点棒数和玩家间的顺位关系，进行分数计算。

得分计算

$$
得分 = 精算点数 + 马点 + 额外段位分
$$

精算点数计算

$$
精算点数 = ceil((点棒数 - 25000) / 1000)
$$

其中，`ceil()`函数表示向上取整。

马点计算

| 顺位 | 马点  |
|----|-----|
| 1  | 15  |
| 2  | 5   |
| 3  | -5  |
| 4  | -15 |

额外段位分计算

- 顺位为1/2的玩家

| 比赛等级 | 东风场1/2顺位额外段位分 | 南风场1/2顺位额外段位分 |
|------|---------------|---------------|
| 铜之间  | 10/5          | 20/10         |
| 银之间  | 20/10         | 40/20         |
| 金之间  | 40/20         | 80/40         |
| 玉之间  | 55/30         | 110/55        |
| 王座之间 | 60/30         | 120/60        |

- 顺位为3的玩家

顺位为3的玩家额外段位分为0。

- 顺位为4的玩家

顺位为4的玩家根据他自己的段位计算额外段位分。额外段位分为负值，也就是额外扣分。

| 段位   | 东风场/南风场4顺位额外扣分 |
|------|----------------|
| 初心1星 | 0 / 0          |
| 初心2星 | 0 / 0          |
| 初心3星 | 0 / 0          |
| 雀士1星 | 10 / 20        |
| 雀士2星 | 20 / 40        |
| 雀士3星 | 30 / 60        |
| 雀杰1星 | 40 / 80        |
| 雀杰2星 | 50 / 100       |
| 雀杰3星 | 60 / 120       |
| 雀豪1星 | 80 / 165       |
| 雀豪2星 | 90 / 180       |
| 雀豪3星 | 100 / 195      |
| 雀圣1星 | 110 / 210      |
| 雀圣2星 | 120 / 225      |
| 雀圣3星 | 130 / 240      |

***如果一名玩家的段位低于比赛等级对应的推荐最低段位，其扣分按比赛等级对应的推荐最低段位扣分。***

| 比赛等级 | 推荐最低段位 |
|------|--------|
| 铜之间  | 初心1星   |
| 银之间  | 雀士1星   |
| 金之间  | 雀杰1星   |
| 玉之间  | 雀豪1星   |
| 王座之间 | 雀圣1星   |

## 4. 项目开发文档

### 4.1 IDE推荐

IDE: VS Code

插件：

1. Tailwind CSS IntelliSense
2. Nuxtr
3. Vue - Official
